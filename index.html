<html>
<head>
<title> XSS SCANNER v1.0 </title>
<meta charset="utf-8">

<link rel="stylesheet" type="text/css" href="mystyle.css">

<script type="text/javascript">

function getSourceAsDOM(url)
{
    url = 'http://allow-any-origin.appspot.com/' + url;
    alert(url);
    xmlhttp=new XMLHttpRequest();
    xmlhttp.open("GET",url,false);
    xmlhttp.send();
    parser=new DOMParser();
    alert(xmlhttp.responseText);
}

function ValidURL(str) {
  var pattern = new RegExp('^(https?:\/\/)?'+ // protocol
    '((([a-z\d]([a-z\d-]*[a-z\d])*)\.)+[a-z]{2,}|'+ // domain name
    '((\d{1,3}\.){3}\d{1,3}))'+ // OR ip (v4) address
    '(\:\d+)?(\/[-a-z\d%_.~+]*)*'+ // port and path
    '(\?[;&a-z\d%_.~+=-]*)?'+ // query string
    '(\#[-a-z\d_]*)?$','i'); // fragment locater
  if(!pattern.test(str)) {
    alert("Please enter a valid URL.");
    return false;
  } else {
    return true;
  }
}

</script>

</head>

 <body>
   <h1> XSS Scanner javascript </h1>
   <input name="urlToAnalyze" id="test2" class="inputPanel" type="text" size="20" maxlength="40" value="Inserire URL da analizzare"/>
   <button onclick="getSourceAsDOM(document.getElementById('test2').value)">Analyze</button>
   <p/>

<input type="file" name="file" id="file">
<script type="text/javascript">
document.getElementById('file').onchange = function(){
 var file = this.files[0];

  var reader = new FileReader();
  reader.onload = function(progressEvent){
    // Entire file
    console.log(this.result);

    // By lines
    var lines = this.result.split('\n');
    var ElementsToAnalyze;
    for(var line = 0; line < lines.length; line++){
      url_to_control = (lines[line]);
      var siteValid = ValidURL(url_to_control);
	if ( siteValid == true )
		{
		ElementsToAnalize[line] = url_to_control;
	}

    }

for (var x=0; x<5; x++){
	alert(ElementsToAnalize[x]);
}
};
  reader.readAsText(file);
}


</script>
</body>
</html>
