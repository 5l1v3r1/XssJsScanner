<html>
<head>
<title> XSS SCANNER v1.0 </title>
<meta charset="utf-8">

<link rel="stylesheet" type="text/css" href="mystyle.css">

<script type="text/javascript">

/*function getSourceAsDOM(url)
{
    url = 'http://allow-any-origin.appspot.com/' + url;
    alert(url);
    xmlhttp=new XMLHttpRequest();
    xmlhttp.open("GET",url,false);
    xmlhttp.send();
    parser=new DOMParser();
    alert(xmlhttp.responseText);
}*/

function ValidURL(textval) {
  urlControl = 'http://allow-any-origin.appspot.com/' + textval;
  xhr = new XMLHttpRequest();
  xhr.open("GET",urlControl,false)
  xhr.send();
  verifyURL = new DOMParser();
  var sito = xhr.responseText;
  UrlExist = xhr.status;
  if (UrlExist != 200)
  {
    return false;
  }
  else {
    return true;
  }
}

</script>

</head>

 <body>
   <h1> XSS Scanner javascript </h1>
   <input name="urlToAnalyze" id="test2" class="inputPanel" type="text" size="20" maxlength="40" value="Inserire URL da analizzare"/>
   <button onclick="getSourceAsDOM(document.getElementById('test2').value)">Ana...lyze</button>
   <p/>

<input type="file" name="file" id="file">
<script type="text/javascript">
document.getElementById('file').onchange = function(){
 var file = this.files[0];

  var reader = new FileReader();
  reader.onload = function(progressEvent){
    // Entire file. Used for debug
    //console.log(this.result);
    var lines = this.result.split('\n');
    let row_number = lines.length;
    console.log(row_number);
    if (lines.length < 6){
      var ElementsToAnalyze=[];
      //Check url validity
      for(var line = 0; line < (lines.length - 1); line++){
        console.log(line, lines.length);
        url_to_control = (lines[line]);
        var siteValid = ValidURL(url_to_control);
          if (siteValid == true){
            ElementsToAnalyze[line] = url_to_control;
          }
      }
  }
    else
    {
        alert("Troppi URL!!!");
    }
};

  reader.readAsText(file);
 }


</script>
</body>
</html>
